var Searchbar=Class.extend({init:function(){this.searchbar=$("[data-searchbar]"),this.searchable=$("[data-searchable]"),0!=this.searchbar.length&&0!=this.searchable.length&&(this.search=$.proxy(this.search,this),this.reset=$.proxy(this.reset,this),this.fields=this.searchbar.find(":input:not(.no-hook)").each(function(a,b){switch(b=$(b),b.prop("type")){case"text":b.keyup(this.search);break;case"select-one":b.change(this.search);break;case"checkbox":b.click(this.search);break;case"reset":b.click(this.reset)}}.bind(this)),this.show_description=!0,this.search(),this.show_description=!1)},search:function(){this.searchbar.trigger("searchbar:before");var a=this.searchable.find("[data-row]");if(0==a.length&&(a=this.searchable.find("tbody tr")),a.show().each(function(a,b){var c=!0,d=$(b);this.fields.each(function(){var a=$(this),b=a.context.type;if("reset"!=b){var e="checkbox"==b?a.context.checked:a.val();if(e&&0!=e.length&&"all"!=e){var f=a.attr("id").replace(/_(?:search|filter|toggle)$/,"");if("text"!=b)c=d.data(f+"-list")?c&&d.is("[data-"+f+"~="+e+"]"):c&&d.data(f)==e;else try{var g=new RegExp(e,"i");c=c&&d.data(f).match(g)}catch(a){}}}}),c||d.hide()}.bind(this)),this.searchbar.trigger("searchbar:after"),this.show_description){var b=this.searchable.find("tbody:visible");1==b.length&&b.addClass("clicked")}},reset:function(){return this.searchbar.trigger("searchbar:reset"),this.searchbar.closest("form").get(0).reset(),this.searchable.find("tbody tr").show(),!1}});$(document).ready(function(){Searchbar=new Searchbar});