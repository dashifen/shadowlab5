function nl2br(e){return void 0===e||null===e?"":(e+"").replace(/(\r\n|\n\r|\r|\n)/g,"<br>$1")}function join(e,t,r){var a="";if(r||(r=9999),t.length>0){t=t.reverse(),a=t.pop();for(var n=0;t.length>0&&n++<r;)a+=e+t.pop()}return a}function array_search(e,t){for(var r=0;r<e.length;r++)for(var a=0;a<t.length;a++)if(t[a]===e[r])return a;return!1}var module={exports:null};!function(){var e=!1,t=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;this.Class=function(){},Class.extend=function(r,a){function n(){!e&&this.init&&this.init.apply(this,arguments)}void 0==a&&(a=r,r="Class");var s=this.prototype;e=!0;var i=new this;e=!1;for(var c in a)i[c]="function"==typeof a[c]&&"function"==typeof s[c]&&t.test(a[c])?function(e,t){return function(){var r=this._super;this._super=s[e];var a=t.apply(this,arguments);return this._super=r,a}}(c,a[c]):a[c];n.prototype=i;var l=new Function("return function "+r+"(){ }")();return n.prototype.constructor=l,n.extend=arguments.callee,n},module.exports=Class}();var Searchbar=Class.extend({searchbar:null,searchable:null,hiddenClass:"searchable-row-hidden",init:function(){if(this.searchbar=document.querySelector(".searchbar"),this.searchable=document.querySelector(".searchable"),this.searchbar&&this.searchable&&this.parseSearchable())for(var e=this.getSearchbarElements(),t=0;t<e.length;++t)this.processSearchbarElement(e[t])},parseSearchable:function(){var e=this.getSearchableRows();if(0===e.length)return!1;for(var t=0;t<e.length;++t)for(var r=e[t].querySelectorAll("[data-searchbar-value]"),a=0;a<r.length;++a)this.processCell(r[a],e[t]);return!0},getSearchableRows:function(){var e=this.searchable.querySelectorAll(".searchable-row");return 0===e.length&&"TABLE"===this.searchable.tagName&&(e=this.searchable.querySelectorAll("tbody tr")),e},processCell:function(e,t){var r="data-"+e.getAttribute("headers"),a=e.getAttribute("data-searchbar-value");t.setAttribute(r,a),"1"===e.getAttribute("data-searchbar-value-list")&&t.setAttribute(r+"-list",1)},getSearchbarElements:function(){return this.searchbar.querySelectorAll("input, select, button")},processSearchbarElement:function(e){var t="",r=0;switch(e.type){case"text":t="keyup",r=150;break;case"select-one":t="change";break;case"checkbox":case"reset":t="click"}if(t.length>0){var a="reset"!==e.type?this.debounce(this.search,r).bind(this):this.reset.bind(this);e.addEventListener(t,a)}},search:function(){var e=new Event("searchbar:beforeSearch");if(this.searchbar.dispatchEvent(e)){this.resetSearchable();for(var t=this.getSearchableRows(),r=0;r<t.length;++r){for(var a=t[r],n=!0,s=this.getSearchbarElements(),i=0;i<s.length;i++)if(n){var c=s[i],l=this.getValue(c),o=this.getAttr(c);if(o&&l&&"all"!==l){var h="text"!==c.type?this.nonTextSearch(a,o,l):this.textSearch(a,o,l);n=n&&h}}n||a.classList.add(this.hiddenClass)}this.searchbar.dispatchEvent(new Event("searchbar:afterSearch"))}},getValue:function(e){switch(e.type){case"text":return e.value;case"select-one":return e.options[e.selectedIndex].value;case"checkbox":return e.checked}return""},getAttr:function(e){var t=e.getAttribute("id");return t?"data-"+(t=t.replace(/_.*/,"")):""},nonTextSearch:function(e,t,r){return e.hasAttribute(t+"-list")?e.matches("["+t+"*=_"+r+"_]"):e.getAttribute(t)===r},textSearch:function(e,t,r){try{var a=new RegExp(r,"i");return e.getAttribute(t).match(a)}catch(e){return!1}},reset:function(){var e=new Event("searchbar:reset");return!this.searchbar.dispatchEvent(e)||(this.searchbar.reset(),this.resetSearchable()),!1},resetSearchable:function(){for(var e=this.getSearchableRows(),t=0;t<e.length;++t)e[t].classList.remove(this.hiddenClass)},debounce:function(e,t,r){if(0===t)return e;var a;return function(){var n=this,s=arguments,i=function(){a=null,r||e.apply(n,s)},c=r&&!a;clearTimeout(a),a=setTimeout(i,t),c&&e.apply(n,s)}}}),Focuser=Class.extend({init:function(){var e=document.querySelector("[autofocus]");if(e&&e.length>0)return void e[0].focus();var t=document.getElementById("shadowlab-form");if(t){var r=t.querySelector("input, select, textarea");r&&r.length>0&&r[0].focus()}}}),Summarizer=Class.extend({element:null,init:function(e){if(e||(e=this.getElement()),e.tagName&&"TABLE"===e.tagName&&e.matches(".summarized"))for(var t=e.querySelectorAll(".summary *:first-child a"),r=0;r<t.length;r++)t[r].addEventListener("click",this.summaryClicked.bind(this))},getElement:function(){return document.querySelector("table.summarized")},summaryClicked:function(e){var t=this.getClosest(e.target,"tbody");this.toggleClass(t,"clicked"),e.stopPropagation(),e.preventDefault()},getClosest:function(e,t){do{if(e.matches(t))return e}while(e=e.parentNode);return null},toggleClass:function(e,t){e.classList.toggle(t,!e.classList.contains(t))}}),Shadowlab=new Vue({data:vueData,el:"#shadowlab",mounted:function(){if(document.title=this.title+" | Shadowlab",this.table.bodies&&this.table.bodies.length>0&&this.table.bodies[0].description.description)for(var e=0;e<this.table.bodies.length;e++)this.table.bodies[e].description.description=nl2br(this.table.bodies[e].description.description)},filters:{capitalize:function(e){return(e+"").replace(/^([a-z\u00E0-\u00FC])|\s+([a-z\u00E0-\u00FC])/g,function(e){return e.toUpperCase()})},nl2br:function(e){return nl2br(e)},makeUpdateLink:function(e){var t=window.location.href.split("/"),r=array_search(["create","read","update","delete"],t);return(!1!==r?join("/",t,r-1):window.location.href)+"/update/"+e},makeCollectionLink:function(e){var t=window.location.href.split("/");return e=array_search([e],t),join("/",t,e)}}});document.addEventListener("DOMContentLoaded",function(){document.getElementsByClassName("searchbar").length>0&&new Searchbar,document.getElementsByClassName("summarized").length>0&&new Summarizer,new Focuser});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNoYWRvd2xhYi5qcyIsIm1vZHVsZS1zdHViLmpzIiwiY2xhc3MuanMiLCJzZWFyY2hiYXIuanMiLCJmb2N1c2VyLmpzIiwic3VtbWFyaXplci5qcyJdLCJuYW1lcyI6WyJubDJiciIsInN0ciIsInJlcGxhY2UiLCJqb2luIiwiZ2x1ZSIsInBpZWNlcyIsImxpbWl0Iiwiam9pbmVkIiwibGVuZ3RoIiwicmV2ZXJzZSIsInBvcCIsImNvdW50IiwiYXJyYXlfc2VhcmNoIiwibmVlZGxlcyIsImhheXN0YWNrIiwiaSIsImoiLCJtb2R1bGUiLCJleHBvcnRzIiwiaW5pdGlhbGl6aW5nIiwiZm5UZXN0IiwidGVzdCIsInh5eiIsInRoaXMiLCJDbGFzcyIsImV4dGVuZCIsImNsYXNzTmFtZSIsInByb3AiLCJpbml0IiwiYXBwbHkiLCJhcmd1bWVudHMiLCJ1bmRlZmluZWQiLCJfc3VwZXIiLCJwcm90b3R5cGUiLCJuYW1lIiwiZm4iLCJ0bXAiLCJyZXQiLCJmdW5jIiwiRnVuY3Rpb24iLCJjb25zdHJ1Y3RvciIsImNhbGxlZSIsIlNlYXJjaGJhciIsInNlYXJjaGJhciIsInNlYXJjaGFibGUiLCJoaWRkZW5DbGFzcyIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsInBhcnNlU2VhcmNoYWJsZSIsImVsZW1lbnRzIiwiZ2V0U2VhcmNoYmFyRWxlbWVudHMiLCJwcm9jZXNzU2VhcmNoYmFyRWxlbWVudCIsInJvd3MiLCJnZXRTZWFyY2hhYmxlUm93cyIsImNlbGxzIiwicXVlcnlTZWxlY3RvckFsbCIsInByb2Nlc3NDZWxsIiwidGFnTmFtZSIsImNlbGwiLCJyb3ciLCJhdHRyIiwiZ2V0QXR0cmlidXRlIiwidmFsdWUiLCJzZXRBdHRyaWJ1dGUiLCJlbGVtZW50IiwiZXZlbnQiLCJ3YWl0IiwidHlwZSIsImRlYm91bmNlIiwic2VhcmNoIiwiYmluZCIsInJlc2V0IiwiYWRkRXZlbnRMaXN0ZW5lciIsImJlZm9yZVNlYXJjaCIsIkV2ZW50IiwiZGlzcGF0Y2hFdmVudCIsInJlc2V0U2VhcmNoYWJsZSIsInNob3ciLCJnZXRWYWx1ZSIsImdldEF0dHIiLCJjcml0ZXJpb24iLCJub25UZXh0U2VhcmNoIiwidGV4dFNlYXJjaCIsImNsYXNzTGlzdCIsImFkZCIsIm9wdGlvbnMiLCJzZWxlY3RlZEluZGV4IiwiY2hlY2tlZCIsImlkIiwiaGFzQXR0cmlidXRlIiwibWF0Y2hlcyIsInBhdHRlcm4iLCJSZWdFeHAiLCJtYXRjaCIsImUiLCJiZWZvcmVSZXNldCIsInJlbW92ZSIsImltbWVkaWF0ZSIsInRpbWVvdXQiLCJjb250ZXh0IiwiYXJncyIsImxhdGVyIiwiY2FsbE5vdyIsImNsZWFyVGltZW91dCIsInNldFRpbWVvdXQiLCJGb2N1c2VyIiwiZm9jdXMiLCJmb3JtIiwiZ2V0RWxlbWVudEJ5SWQiLCJpbnB1dHMiLCJTdW1tYXJpemVyIiwiZ2V0RWxlbWVudCIsImNsaWNrZXJzIiwic3VtbWFyeUNsaWNrZWQiLCJ0Ym9keSIsImdldENsb3Nlc3QiLCJ0YXJnZXQiLCJ0b2dnbGVDbGFzcyIsInN0b3BQcm9wYWdhdGlvbiIsInByZXZlbnREZWZhdWx0IiwicGFyZW50Tm9kZSIsInRvZ2dsZSIsImNvbnRhaW5zIiwiU2hhZG93bGFiIiwiVnVlIiwiZGF0YSIsInZ1ZURhdGEiLCJlbCIsIm1vdW50ZWQiLCJ0aXRsZSIsInRhYmxlIiwiYm9kaWVzIiwiZGVzY3JpcHRpb24iLCJmaWx0ZXJzIiwiY2FwaXRhbGl6ZSIsIiQxIiwidG9VcHBlckNhc2UiLCJtYWtlVXBkYXRlTGluayIsImhyZWZQYXJ0cyIsIndpbmRvdyIsImxvY2F0aW9uIiwiaHJlZiIsInNwbGl0IiwiZW5kcG9pbnQiLCJtYWtlQ29sbGVjdGlvbkxpbmsiLCJnZXRFbGVtZW50c0J5Q2xhc3NOYW1lIl0sIm1hcHBpbmdzIjoiQUFpR0EsUUFBQUEsT0FBQUMsR0FJQSxXQUFBLEtBQUFBLEdBQUEsT0FBQUEsRUFDQSxJQU1BQSxFQUFBLElBQUFDLFFBQUEscUJBQUEsVUFHQSxRQUFBQyxNQUFBQyxFQUFBQyxFQUFBQyxHQUNBLEdBQUFDLEdBQUEsRUFhQSxJQVhBRCxJQUNBQSxFQUFBLE1BVUFELEVBQUFHLE9BQUEsRUFBQSxDQUNBSCxFQUFBQSxFQUFBSSxVQUNBRixFQUFBRixFQUFBSyxLQUdBLEtBREEsR0FBQUMsR0FBQSxFQUNBTixFQUFBRyxPQUFBLEdBQUFHLElBQUFMLEdBQ0FDLEdBQUFILEVBQUFDLEVBQUFLLE1BSUEsTUFBQUgsR0FHQSxRQUFBSyxjQUFBQyxFQUFBQyxHQU1BLElBQUEsR0FBQUMsR0FBQSxFQUFBQSxFQUFBRixFQUFBTCxPQUFBTyxJQUNBLElBQUEsR0FBQUMsR0FBQSxFQUFBQSxFQUFBRixFQUFBTixPQUFBUSxJQUNBLEdBQUFGLEVBQUFFLEtBQUFILEVBQUFFLEdBQ0EsTUFBQUMsRUFLQSxRQUFBLEVDeEpBLEdBQUFDLFNBQUFDLFFBQUEsT0NBQSxXQUNBLEdBQUFDLElBQUEsRUFBQUMsRUFBQSxNQUFBQyxLQUFBLFdBQUFDLE1BQUEsYUFBQSxJQUdBQyxNQUFBQyxNQUFBLGFBR0FBLE1BQUFDLE9BQUEsU0FBQUMsRUFBQUMsR0F1Q0EsUUFBQUgsTUFFQUwsR0FBQUksS0FBQUssTUFDQUwsS0FBQUssS0FBQUMsTUFBQU4sS0FBQU8sZUF6Q0FDLElBQUFKLElBQ0FBLEVBQUFELEVBQ0FBLEVBQUEsUUFHQSxJQUFBTSxHQUFBVCxLQUFBVSxTQUlBZCxJQUFBLENBQ0EsSUFBQWMsR0FBQSxHQUFBVixLQUNBSixJQUFBLENBR0EsS0FBQSxHQUFBZSxLQUFBUCxHQUVBTSxFQUFBQyxHQUFBLGtCQUFBUCxHQUFBTyxJQUNBLGtCQUFBRixHQUFBRSxJQUFBZCxFQUFBQyxLQUFBTSxFQUFBTyxJQUNBLFNBQUFBLEVBQUFDLEdBQ0EsTUFBQSxZQUNBLEdBQUFDLEdBQUFiLEtBQUFTLE1BSUFULE1BQUFTLE9BQUFBLEVBQUFFLEVBSUEsSUFBQUcsR0FBQUYsRUFBQU4sTUFBQU4sS0FBQU8sVUFHQSxPQUZBUCxNQUFBUyxPQUFBSSxFQUVBQyxJQUVBSCxFQUFBUCxFQUFBTyxJQUNBUCxFQUFBTyxFQVdBVixHQUFBUyxVQUFBQSxDQUdBLElBQUFLLEdBQUEsR0FBQUMsVUFDQSxtQkFBQWIsRUFBQSxVQU9BLE9BTEFGLEdBQUFTLFVBQUFPLFlBQUFGLEVBR0FkLEVBQUFDLE9BQUFLLFVBQUFXLE9BRUFqQixHQUlBUCxPQUFBQyxRQUFBTSxRQy9EQSxJQUFBa0IsV0FBQWxCLE1BQUFDLFFBQ0FrQixVQUFBLEtBQ0FDLFdBQUEsS0FDQUMsWUFBQSx3QkFFQWpCLEtBQUEsV0FRQSxHQVBBTCxLQUFBb0IsVUFBQUcsU0FBQUMsY0FBQSxjQUNBeEIsS0FBQXFCLFdBQUFFLFNBQUFDLGNBQUEsZUFNQXhCLEtBQUFvQixXQUFBcEIsS0FBQXFCLFlBU0FyQixLQUFBeUIsa0JBUUEsSUFBQSxHQURBQyxHQUFBMUIsS0FBQTJCLHVCQUNBbkMsRUFBQSxFQUFBQSxFQUFBa0MsRUFBQXpDLFNBQUFPLEVBQ0FRLEtBQUE0Qix3QkFBQUYsRUFBQWxDLEtBSUFpQyxnQkFBQSxXQUNBLEdBQUFJLEdBQUE3QixLQUFBOEIsbUJBSUEsSUFBQSxJQUFBRCxFQUFBNUMsT0FDQSxPQUFBLENBT0EsS0FBQSxHQUFBTyxHQUFBLEVBQUFBLEVBQUFxQyxFQUFBNUMsU0FBQU8sRUFFQSxJQUFBLEdBREF1QyxHQUFBRixFQUFBckMsR0FBQXdDLGlCQUFBLDBCQUNBdkMsRUFBQSxFQUFBQSxFQUFBc0MsRUFBQTlDLFNBQUFRLEVBQ0FPLEtBQUFpQyxZQUFBRixFQUFBdEMsR0FBQW9DLEVBQUFyQyxHQUlBLFFBQUEsR0FHQXNDLGtCQUFBLFdBUUEsR0FBQUQsR0FBQTdCLEtBQUFxQixXQUFBVyxpQkFBQSxrQkFLQSxPQUpBLEtBQUFILEVBQUE1QyxRQUFBLFVBQUFlLEtBQUFxQixXQUFBYSxVQUNBTCxFQUFBN0IsS0FBQXFCLFdBQUFXLGlCQUFBLGFBR0FILEdBR0FJLFlBQUEsU0FBQUUsRUFBQUMsR0FPQSxHQUFBQyxHQUFBLFFBQUFGLEVBQUFHLGFBQUEsV0FDQUMsRUFBQUosRUFBQUcsYUFBQSx1QkFDQUYsR0FBQUksYUFBQUgsRUFBQUUsR0FFQSxNQUFBSixFQUFBRyxhQUFBLDhCQUNBRixFQUFBSSxhQUFBSCxFQUFBLFFBQUEsSUFJQVYscUJBQUEsV0FLQSxNQUFBM0IsTUFBQW9CLFVBQUFZLGlCQUFBLDBCQUdBSix3QkFBQSxTQUFBYSxHQUNBLEdBQUFDLEdBQUEsR0FBQUMsRUFBQSxDQU9BLFFBQUFGLEVBQUFHLE1BQ0EsSUFBQSxPQUNBRixFQUFBLFFBQ0FDLEVBQUEsR0FDQSxNQUVBLEtBQUEsYUFDQUQsRUFBQSxRQUNBLE1BRUEsS0FBQSxXQUlBLElBQUEsUUFDQUEsRUFBQSxRQUlBLEdBQUFBLEVBQUF6RCxPQUFBLEVBQUEsQ0FNQSxHQUFBOEIsR0FBQSxVQUFBMEIsRUFBQUcsS0FDQTVDLEtBQUE2QyxTQUFBN0MsS0FBQThDLE9BQUFILEdBQUFJLEtBQUEvQyxNQUNBQSxLQUFBZ0QsTUFBQUQsS0FBQS9DLEtBRUF5QyxHQUFBUSxpQkFBQVAsRUFBQTNCLEtBSUErQixPQUFBLFdBQ0EsR0FBQUksR0FBQSxHQUFBQyxPQUFBLHlCQUVBLElBREFuRCxLQUFBb0IsVUFBQWdDLGNBQUFGLEdBQ0EsQ0FTQWxELEtBQUFxRCxpQkFFQSxLQUFBLEdBREF4QixHQUFBN0IsS0FBQThCLG9CQUNBdEMsRUFBQSxFQUFBQSxFQUFBcUMsRUFBQTVDLFNBQUFPLEVBQUEsQ0FRQSxJQUFBLEdBUEE0QyxHQUFBUCxFQUFBckMsR0FBQThELEdBQUEsRUFNQTVCLEVBQUExQixLQUFBMkIsdUJBQ0FsQyxFQUFBLEVBQUFBLEVBQUFpQyxFQUFBekMsT0FBQVEsSUFDQSxHQUFBNkQsRUFBQSxDQVNBLEdBQUFiLEdBQUFmLEVBQUFqQyxHQUNBOEMsRUFBQXZDLEtBQUF1RCxTQUFBZCxHQUNBSixFQUFBckMsS0FBQXdELFFBQUFmLEVBT0EsSUFBQUosR0FBQUUsR0FBQSxRQUFBQSxFQUFBLENBSUEsR0FBQWtCLEdBQUEsU0FBQWhCLEVBQUFHLEtBQ0E1QyxLQUFBMEQsY0FBQXRCLEVBQUFDLEVBQUFFLEdBQ0F2QyxLQUFBMkQsV0FBQXZCLEVBQUFDLEVBQUFFLEVBRUFlLEdBQUFBLEdBQUFHLEdBR0FILEdBS0FsQixFQUFBd0IsVUFBQUMsSUFBQTdELEtBQUFzQixhQUlBdEIsS0FBQW9CLFVBQUFnQyxjQUFBLEdBQUFELE9BQUEsNEJBR0FJLFNBQUEsU0FBQWQsR0FRQSxPQUFBQSxFQUFBRyxNQUNBLElBQUEsT0FDQSxNQUFBSCxHQUFBRixLQUVBLEtBQUEsYUFDQSxNQUFBRSxHQUFBcUIsUUFBQXJCLEVBQUFzQixlQUFBeEIsS0FFQSxLQUFBLFdBQ0EsTUFBQUUsR0FBQXVCLFFBR0EsTUFBQSxJQUdBUixRQUFBLFNBQUFmLEdBTUEsR0FBQXdCLEdBQUF4QixFQUFBSCxhQUFBLEtBRUEsT0FBQTJCLEdBZ0JBLFNBUkFBLEVBQUFBLEVBQUF0RixRQUFBLE1BQUEsS0FFQSxJQVNBK0UsY0FBQSxTQUFBdEIsRUFBQUMsRUFBQUUsR0FVQSxNQUFBSCxHQUFBOEIsYUFBQTdCLEVBQUEsU0FDQUQsRUFBQStCLFFBQUEsSUFBQTlCLEVBQUEsTUFBQUUsRUFBQSxNQUNBSCxFQUFBRSxhQUFBRCxLQUFBRSxHQUdBb0IsV0FBQSxTQUFBdkIsRUFBQUMsRUFBQUUsR0FRQSxJQUNBLEdBQUE2QixHQUFBLEdBQUFDLFFBQUE5QixFQUFBLElBQ0EsT0FBQUgsR0FBQUUsYUFBQUQsR0FBQWlDLE1BQUFGLEdBQ0EsTUFBQUcsR0FNQSxPQUFBLElBSUF2QixNQUFBLFdBQ0EsR0FBQXdCLEdBQUEsR0FBQXJCLE9BQUEsa0JBWUEsUUFYQW5ELEtBQUFvQixVQUFBZ0MsY0FBQW9CLEtBT0F4RSxLQUFBb0IsVUFBQTRCLFFBQ0FoRCxLQUFBcUQsb0JBR0EsR0FHQUEsZ0JBQUEsV0FNQSxJQUFBLEdBTEF4QixHQUFBN0IsS0FBQThCLG9CQUtBdEMsRUFBQSxFQUFBQSxFQUFBcUMsRUFBQTVDLFNBQUFPLEVBQ0FxQyxFQUFBckMsR0FBQW9FLFVBQUFhLE9BQUF6RSxLQUFBc0IsY0FJQXVCLFNBQUEsU0FBQTlCLEVBQUE0QixFQUFBK0IsR0FDQSxHQUFBLElBQUEvQixFQUNBLE1BQUE1QixFQUtBLElBQUE0RCxFQUNBLE9BQUEsWUFDQSxHQUFBQyxHQUFBNUUsS0FBQTZFLEVBQUF0RSxVQUNBdUUsRUFBQSxXQUNBSCxFQUFBLEtBQ0FELEdBQUEzRCxFQUFBVCxNQUFBc0UsRUFBQUMsSUFFQUUsRUFBQUwsSUFBQUMsQ0FDQUssY0FBQUwsR0FDQUEsRUFBQU0sV0FBQUgsRUFBQW5DLEdBQ0FvQyxHQUFBaEUsRUFBQVQsTUFBQXNFLEVBQUFDLE9DalZBSyxRQUFBakYsTUFBQUMsUUFDQUcsS0FBQSxXQUNBLEdBQUFvQyxHQUFBbEIsU0FBQUMsY0FBQSxjQUNBLElBQUFpQixHQUFBQSxFQUFBeEQsT0FBQSxFQUVBLFdBREF3RCxHQUFBLEdBQUEwQyxPQU9BLElBQUFDLEdBQUE3RCxTQUFBOEQsZUFBQSxpQkFDQSxJQUFBRCxFQUFBLENBQ0EsR0FBQUUsR0FBQUYsRUFBQTVELGNBQUEsMEJBQ0E4RCxJQUFBQSxFQUFBckcsT0FBQSxHQUNBcUcsRUFBQSxHQUFBSCxZQ2ZBSSxXQUFBdEYsTUFBQUMsUUFDQXVDLFFBQUEsS0FPQXBDLEtBQUEsU0FBQW9DLEdBS0EsR0FKQUEsSUFDQUEsRUFBQXpDLEtBQUF3RixjQUdBL0MsRUFBQVAsU0FDQSxVQUFBTyxFQUFBUCxTQUNBTyxFQUFBMEIsUUFBQSxlQU9BLElBQUEsR0FEQXNCLEdBQUFoRCxFQUFBVCxpQkFBQSw0QkFDQXhDLEVBQUEsRUFBQUEsRUFBQWlHLEVBQUF4RyxPQUFBTyxJQUNBaUcsRUFBQWpHLEdBQUF5RCxpQkFBQSxRQUFBakQsS0FBQTBGLGVBQUEzQyxLQUFBL0MsUUFLQXdGLFdBQUEsV0FNQSxNQUFBakUsVUFBQUMsY0FBQSxxQkFHQWtFLGVBQUEsU0FBQWhELEdBS0EsR0FBQWlELEdBQUEzRixLQUFBNEYsV0FBQWxELEVBQUFtRCxPQUFBLFFBQ0E3RixNQUFBOEYsWUFBQUgsRUFBQSxXQUNBakQsRUFBQXFELGtCQUNBckQsRUFBQXNELGtCQUdBSixXQUFBLFNBQUFuRCxFQUFBb0QsR0FNQSxHQUNBLEdBQUFwRCxFQUFBMEIsUUFBQTBCLEdBQ0EsTUFBQXBELFNBRUFBLEVBQUFBLEVBQUF3RCxXQUtBLE9BQUEsT0FHQUgsWUFBQSxTQUFBckQsRUFBQXRDLEdBQ0FzQyxFQUFBbUIsVUFBQXNDLE9BQUEvRixHQUFBc0MsRUFBQW1CLFVBQUF1QyxTQUFBaEcsT0xuRUFpRyxVQUFBLEdBQUFDLE1BQ0FDLEtBQUFDLFFBQ0FDLEdBQUEsYUFNQUMsUUFBQSxXQVlBLEdBWEFsRixTQUFBbUYsTUFBQTFHLEtBQUEwRyxNQUFBLGVBUUExRyxLQUFBMkcsTUFBQUMsUUFBQTVHLEtBQUEyRyxNQUFBQyxPQUFBM0gsT0FBQSxHQUNBZSxLQUFBMkcsTUFBQUMsT0FBQSxHQUFBQyxZQUFBQSxZQUdBLElBQUEsR0FBQXJILEdBQUEsRUFBQUEsRUFBQVEsS0FBQTJHLE1BQUFDLE9BQUEzSCxPQUFBTyxJQUNBUSxLQUFBMkcsTUFBQUMsT0FBQXBILEdBQUFxSCxZQUFBQSxZQUFBcEksTUFBQXVCLEtBQUEyRyxNQUFBQyxPQUFBcEgsR0FBQXFILFlBQUFBLGNBS0FDLFNBQ0FDLFdBQUEsU0FBQXJJLEdBSUEsT0FBQUEsRUFBQSxJQUFBQyxRQUFBLGlEQUFBLFNBQUFxSSxHQUNBLE1BQUFBLEdBQUFDLGlCQUlBeEksTUFBQSxTQUFBQyxHQUNBLE1BQUFELE9BQUFDLElBR0F3SSxlQUFBLFNBQUFqRCxHQUNBLEdBQUFrRCxHQUFBQyxPQUFBQyxTQUFBQyxLQUFBQyxNQUFBLEtBUUFDLEVBQUFuSSxjQUFBLFNBQUEsT0FBQSxTQUFBLFVBQUE4SCxFQVlBLFNBSkEsSUFBQUssRUFDQTVJLEtBQUEsSUFBQXVJLEVBQUFLLEVBQUEsR0FDQUosT0FBQUMsU0FBQUMsTUFFQSxXQUFBckQsR0FHQXdELG1CQUFBLFNBQUFELEdBQ0EsR0FBQUwsR0FBQUMsT0FBQUMsU0FBQUMsS0FBQUMsTUFBQSxJQVFBLE9BREFDLEdBQUFuSSxjQUFBbUksR0FBQUwsR0FDQXZJLEtBQUEsSUFBQXVJLEVBQUFLLE1BS0FqRyxVQUFBMEIsaUJBQUEsbUJBQUEsV0FDQTFCLFNBQUFtRyx1QkFBQSxhQUFBekksT0FBQSxHQUNBLEdBQUFrQyxXQUdBSSxTQUFBbUcsdUJBQUEsY0FBQXpJLE9BQUEsR0FDQSxHQUFBc0csWUFHQSxHQUFBTCIsImZpbGUiOiJzaGFkb3dsYWIuY29tcGxldGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgU2hhZG93bGFiID0gbmV3IFZ1ZSh7XHJcblx0ZGF0YTogdnVlRGF0YSxcclxuXHRlbDogXCIjc2hhZG93bGFiXCIsXHJcblxyXG5cdC8vIHNpbmNlIHRoZSA8dGl0bGU+IHRhZyBpcyBvdXRzaWRlIG9mIHRoZSBkaXYjc2hhZG93bGFiIGVsZW1lbnQsXHJcblx0Ly8gd2UgaGF2ZSB0byBhbHRlciBpdCBhZnRlciB0aGUgVnVlIG9iamVjdCBpcyBtb3VudGVkIGJ5IGhhbmQgYXNcclxuXHQvLyBmb2xsb3dzLlxyXG5cclxuXHRtb3VudGVkOiBmdW5jdGlvbigpIHtcclxuXHRcdGRvY3VtZW50LnRpdGxlID0gdGhpcy50aXRsZSArIFwiIHwgU2hhZG93bGFiXCI7XHJcblxyXG5cdFx0Ly8gYWxzbywgaWYgd2UgaGF2ZSB0YWJsZSBib2RpZXMgYW5kIHRoZXkgaGF2ZSBkZXNjcmlwdGlvbnMsIHdlIHdhbnRcclxuXHRcdC8vIHRvIHF1aWNrbHkgY29udmVydCBuZXcgbGluZSBjaGFyYWN0ZXJzIHRvIDxicj4gdGFncy4gIHdlIGhhdmUgYVxyXG5cdFx0Ly8gZnVuY3Rpb24gYmVsb3cgdGhhdCdsbCBkbyB0aGUgd29yaywgc28gaGVyZSB3ZSBqdXN0IHNlZSBpZiBpdCdzXHJcblx0XHQvLyBuZWNlc3NhcnkgYW5kLCBpZiBzbywgd2UgbG9vcCBvdmVyIG91ciB0YWJsZSBib2RpZXMgYW5kIGNhbGwgdGhhdFxyXG5cdFx0Ly8gZnVuY3Rpb24uXHJcblxyXG5cdFx0dmFyIHdpdGhCb2RpZXMgPSB0aGlzLnRhYmxlLmJvZGllcyAmJiB0aGlzLnRhYmxlLmJvZGllcy5sZW5ndGggPiAwO1xyXG5cdFx0dmFyIHdpdGhEZXNjcmlwdGlvbnMgPSB3aXRoQm9kaWVzICYmIHRoaXMudGFibGUuYm9kaWVzWzBdLmRlc2NyaXB0aW9uLmRlc2NyaXB0aW9uO1xyXG5cclxuXHRcdGlmICh3aXRoRGVzY3JpcHRpb25zKSB7XHJcblx0XHRcdGZvciAodmFyIGk9MDsgaSA8IHRoaXMudGFibGUuYm9kaWVzLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdFx0dGhpcy50YWJsZS5ib2RpZXNbaV0uZGVzY3JpcHRpb24uZGVzY3JpcHRpb24gPSBubDJicih0aGlzLnRhYmxlLmJvZGllc1tpXS5kZXNjcmlwdGlvbi5kZXNjcmlwdGlvbik7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9LFxyXG5cclxuXHRmaWx0ZXJzOiB7XHJcblx0XHRjYXBpdGFsaXplOiBmdW5jdGlvbihzdHIpIHtcclxuXHJcblx0XHRcdC8vIHNvdXJjZTogaHR0cDovL2xvY3V0dXMuaW8vcGhwL3N0cmluZ3MvdWN3b3Jkcy9cclxuXHJcblx0XHRcdHJldHVybiAoc3RyICsgJycpLnJlcGxhY2UoL14oW2EtelxcdTAwRTAtXFx1MDBGQ10pfFxccysoW2EtelxcdTAwRTAtXFx1MDBGQ10pL2csIGZ1bmN0aW9uKCQxKSB7XHJcblx0XHRcdFx0cmV0dXJuICQxLnRvVXBwZXJDYXNlKClcclxuXHRcdFx0fSlcclxuXHRcdH0sXHJcblxyXG5cdFx0bmwyYnI6IGZ1bmN0aW9uKHN0cikge1xyXG5cdFx0XHRyZXR1cm4gbmwyYnIoc3RyKTtcclxuXHRcdH0sXHJcblxyXG5cdFx0bWFrZVVwZGF0ZUxpbms6IGZ1bmN0aW9uKGlkKSB7XHJcblx0XHRcdHZhciBocmVmUGFydHMgPSB3aW5kb3cubG9jYXRpb24uaHJlZi5zcGxpdChcIi9cIik7XHJcblxyXG5cdFx0XHQvLyB3ZSBjb3VsZCBiZSBjcmVhdGluZyBhbiB1cGRhdGUgbGluayBmcm9tIGFsbW9zdCBhbnkgb2Ygb3VyXHJcblx0XHRcdC8vIHBhZ2VzLCBzbyB3ZSB3YW50IHRvIHNlYXJjaCB0aHJvdWdoIHRoZSBwYXJ0cyBvZiBvdXIgY3VycmVudFxyXG5cdFx0XHQvLyBocmVmIGZvciBhbnkgb2Ygb3VyIGFwcGxpY2F0aW9uIGFjdGlvbnMuICB3aGVuIHdlIGlkZW50aWZ5XHJcblx0XHRcdC8vIG9uZSBvZiB0aGVtLCB3ZSBrbm93IHdoZXJlIHRvIHN0b3Agb3VyIHJlLWpvaW5pbmcgYWN0aW9uIGZvclxyXG5cdFx0XHQvLyBvdXIgbmV3IGhyZWYuXHJcblxyXG5cdFx0XHR2YXIgZW5kcG9pbnQgPSBhcnJheV9zZWFyY2goW1wiY3JlYXRlXCIsIFwicmVhZFwiLCBcInVwZGF0ZVwiLCBcImRlbGV0ZVwiXSwgaHJlZlBhcnRzKTtcclxuXHJcblx0XHRcdC8vIG5vdywgaWYgd2UgZm91bmQgb25lIG9mIG91ciBhY3Rpb24gdmVyYnMgZHVyaW5nIG91ciBzZWFyY2gsIHdlXHJcblx0XHRcdC8vIHdhbnQgdG8gam9pbiB0aGUgaHJlZiBwYXJ0cyBiYWNrIHRvZ2V0aGVyIGFnYWluIHVwIHRvIGJ1dCBub3RcclxuXHRcdFx0Ly8gaW5jbHVkaW5nIHRoYXQgdmVyYiAoaGVuY2UgdGhlIC0xKS4gIGlmIHdlIGNvdWxkbid0IGZpbmQgb25lXHJcblx0XHRcdC8vIG9mIG91ciB2ZXJicywgd2UganVzdCB1c2UgdGhlIGN1cnJlbnQgaHJlZiBhcyB0aGUgYmFzZSBvZiBvdXJcclxuXHRcdFx0Ly8gdXBkYXRlIGxpbmsuXHJcblxyXG5cdFx0XHR2YXIgaHJlZiA9IGVuZHBvaW50ICE9PSBmYWxzZVxyXG5cdFx0XHRcdD8gam9pbihcIi9cIiwgaHJlZlBhcnRzLCBlbmRwb2ludCAtIDEpXHJcblx0XHRcdFx0OiB3aW5kb3cubG9jYXRpb24uaHJlZjtcclxuXHJcblx0XHRcdHJldHVybiBocmVmICsgJy91cGRhdGUvJyArIGlkO1xyXG5cdFx0fSxcclxuXHJcblx0XHRtYWtlQ29sbGVjdGlvbkxpbms6IGZ1bmN0aW9uKGVuZHBvaW50KSB7XHJcblx0XHRcdHZhciBocmVmUGFydHMgPSB3aW5kb3cubG9jYXRpb24uaHJlZi5zcGxpdChcIi9cIik7XHJcblxyXG5cdFx0XHQvLyBoZXJlLCB3ZSB3YW50IHRvIHN0b3AgdGhlIHJlLWJ1aWxkaW5nIG9mIG91ciBocmVmIGF0IHRoZVxyXG5cdFx0XHQvLyBzcGVjaWZpZWQgZW5kcG9pbnQuICByZW1lbWJlcjogYXJyYXlfc2VhcmNoKCkgYmVsb3cgdXNlcyBhblxyXG5cdFx0XHQvLyBBcnJheSBhcyB0aGUgZmlyc3QgYXJndW1lbnQsIHNvIHdlIGNyYW0gb3VyIGVuZHBvaW50XHJcblx0XHRcdC8vIHBhcmFtZXRlciBpbnRvIG9uZSBhcyB3ZSBzZW5kIGl0IHRoZXJlLlxyXG5cclxuXHRcdFx0ZW5kcG9pbnQgPSBhcnJheV9zZWFyY2goW2VuZHBvaW50XSwgaHJlZlBhcnRzKTtcclxuXHRcdFx0cmV0dXJuIGpvaW4oXCIvXCIsIGhyZWZQYXJ0cywgZW5kcG9pbnQpO1xyXG5cdFx0fVxyXG5cdH1cclxufSk7XHJcblxyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCBmdW5jdGlvbigpIHtcclxuXHRpZiAoZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcInNlYXJjaGJhclwiKS5sZW5ndGggPiAwKSB7XHJcblx0XHRuZXcgU2VhcmNoYmFyKCk7XHJcblx0fVxyXG5cclxuXHRpZiAoZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcInN1bW1hcml6ZWRcIikubGVuZ3RoID4gMCkge1xyXG5cdFx0bmV3IFN1bW1hcml6ZXIoKTtcclxuXHR9XHJcblxyXG5cdG5ldyBGb2N1c2VyKCk7XHJcbn0pO1xyXG5cclxuLypcclxuICogQWRkaXRpb25hbC9IZWxwZXIgZnVuY3Rpb25zXHJcbiAqIFRoZXNlIGZ1bmN0aW9ucyBhcmUgdXNlZCBhYm92ZSB0byBhc3Npc3QgaW4gZmlsdGVycywgZm9yIGV4YW1wbGUuXHJcbiAqIFVzdWFsbHksIHRoZXkncmUgbW9jay11cHMgb2YgUEhQLWxpa2UgZnVuY3Rpb25zIGZvciBvdXIgY29udmVuaWVuY2UuXHJcbiAqL1xyXG5cclxuZnVuY3Rpb24gbmwyYnIoc3RyKSB7XHJcblxyXG5cdC8vIHNvdXJjZTogaHR0cDovL2xvY3V0dXMuaW8vcGhwL3N0cmluZ3MvbmwyYnIvXHJcblxyXG5cdGlmICh0eXBlb2Ygc3RyID09PSAndW5kZWZpbmVkJyB8fCBzdHIgPT09IG51bGwpIHtcclxuXHRcdHJldHVybiAnJ1xyXG5cdH1cclxuXHJcblx0Ly8gYWx0ZXJlZCBzb3VyY2U6IHJlbW92ZWQgc3dpdGNoIGJldHdlZW4gWEhUTUwgYW5kIEhUTUxcclxuXHQvLyB2ZXJzaW9uIG9mIHRoZSBicmVhayB0YWcuXHJcblxyXG5cdHJldHVybiAoc3RyICsgJycpLnJlcGxhY2UoLyhcXHJcXG58XFxuXFxyfFxccnxcXG4pL2csICc8YnI+JyArICckMScpXHJcbn1cclxuXHJcbmZ1bmN0aW9uIGpvaW4oZ2x1ZSwgcGllY2VzLCBsaW1pdCkge1xyXG5cdHZhciBqb2luZWQgPSAnJztcclxuXHJcblx0aWYgKCFsaW1pdCkge1xyXG5cdFx0bGltaXQgPSA5OTk5O1xyXG5cdH1cclxuXHJcblx0Ly8gYXMgbG9uZyBhcyB3ZSBoYXZlIG1vcmUgdGhhbiBvbmUgcGllY2UsIHdlJ2xsIHJldmVyc2Ugb3VyXHJcblx0Ly8gYXJyYXkgYW5kIHBvcCBpdGVtcyBvZmYgb2YgaXQgdG8gY3JlYXRlIG91ciBqb2luZWQgc3RyaW5nLlxyXG5cdC8vIHNvLCBpZiBvdXIgYXJyYXkgaXMgW0EsIEIsIENdLCB0aGUgcmV2ZXJzYWwgaXMsIG9idmlvdXNseSxcclxuXHQvLyBbQywgQiwgQV0uICB0aGVuLCB3ZSBzdGFydCBvdXIgc3RyaW5nIGJ5IHBvcHBpbmcgdGhlIEEgb2ZmLlxyXG5cdC8vIHRoZW4sIHdlIHBvcCB0aGUgQiBhbmQgdGhlIEMgb2ZmIGFuZCBwcmVmaXhpbmcgdGhlbSB3aXRoXHJcblx0Ly8gdGhlIGdsdWUuXHJcblxyXG5cdGlmIChwaWVjZXMubGVuZ3RoID4gMCkge1xyXG5cdFx0cGllY2VzID0gcGllY2VzLnJldmVyc2UoKTtcclxuXHRcdGpvaW5lZCA9IHBpZWNlcy5wb3AoKTtcclxuXHJcblx0XHR2YXIgY291bnQgPSAwO1xyXG5cdFx0d2hpbGUocGllY2VzLmxlbmd0aCA+IDAgJiYgY291bnQrKyA8IGxpbWl0KSB7XHJcblx0XHRcdGpvaW5lZCArPSBnbHVlICsgcGllY2VzLnBvcCgpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0cmV0dXJuIGpvaW5lZDtcclxufVxyXG5cclxuZnVuY3Rpb24gYXJyYXlfc2VhcmNoIChuZWVkbGVzLCBoYXlzdGFjaykge1xyXG5cclxuXHQvLyBsaWtlIHRoZSBQSFAgZnVuY3Rpb24gb2YgdGhlIHNhbWUgbmFtZSwgd2Ugd2FudCB0byByZXR1cm4gdGhlXHJcblx0Ly8gaW5kZXggb2Ygb3VyIGZpcnN0IG5lZWRsZSB3aXRoaW4gdGhlIGhheXN0YWNrLiAgc28gd2UgbG9vcCBvdmVyXHJcblx0Ly8gdGhlIG5lZWRsZXMgYW5kIGNvbXBhcmUgdGhlbSBhZ2FpbnN0IHRoZSBoYXlzdGFjayBhcnJheS5cclxuXHJcblx0Zm9yICh2YXIgaT0wOyBpIDwgbmVlZGxlcy5sZW5ndGg7IGkrKykge1xyXG5cdFx0Zm9yICh2YXIgaj0wOyBqIDwgaGF5c3RhY2subGVuZ3RoOyBqKyspIHtcclxuXHRcdFx0aWYgKGhheXN0YWNrW2pdID09PSBuZWVkbGVzW2ldKSB7XHJcblx0XHRcdFx0cmV0dXJuIGo7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdHJldHVybiBmYWxzZVxyXG59XHJcbiIsInZhciBtb2R1bGUgPSB7IGV4cG9ydHM6IG51bGwgfTtcclxuIiwiKGZ1bmN0aW9uKCl7XG4gIHZhciBpbml0aWFsaXppbmcgPSBmYWxzZSwgZm5UZXN0ID0gL3h5ei8udGVzdChmdW5jdGlvbigpe3h5ejt9KSA/IC9cXGJfc3VwZXJcXGIvIDogLy4qLztcblxuICAvLyBUaGUgYmFzZSBDbGFzcyBpbXBsZW1lbnRhdGlvbiAoZG9lcyBub3RoaW5nKVxuICB0aGlzLkNsYXNzID0gZnVuY3Rpb24oKXt9O1xuXG4gIC8vIENyZWF0ZSBhIG5ldyBDbGFzcyB0aGF0IGluaGVyaXRzIGZyb20gdGhpcyBjbGFzc1xuICBDbGFzcy5leHRlbmQgPSBmdW5jdGlvbihjbGFzc05hbWUsIHByb3ApIHtcbiAgICBpZihwcm9wID09IHVuZGVmaW5lZCkge1xuICAgICAgICBwcm9wID0gY2xhc3NOYW1lO1xuICAgICAgIGNsYXNzTmFtZSA9IFwiQ2xhc3NcIjtcbiAgICB9XG5cbiAgICB2YXIgX3N1cGVyID0gdGhpcy5wcm90b3R5cGU7XG5cbiAgICAvLyBJbnN0YW50aWF0ZSBhIGJhc2UgY2xhc3MgKGJ1dCBvbmx5IGNyZWF0ZSB0aGUgaW5zdGFuY2UsXG4gICAgLy8gZG9uJ3QgcnVuIHRoZSBpbml0IGNvbnN0cnVjdG9yKVxuICAgIGluaXRpYWxpemluZyA9IHRydWU7XG4gICAgdmFyIHByb3RvdHlwZSA9IG5ldyB0aGlzKCk7XG4gICAgaW5pdGlhbGl6aW5nID0gZmFsc2U7XG5cbiAgICAvLyBDb3B5IHRoZSBwcm9wZXJ0aWVzIG92ZXIgb250byB0aGUgbmV3IHByb3RvdHlwZVxuICAgIGZvciAodmFyIG5hbWUgaW4gcHJvcCkge1xuICAgICAgLy8gQ2hlY2sgaWYgd2UncmUgb3ZlcndyaXRpbmcgYW4gZXhpc3RpbmcgZnVuY3Rpb25cbiAgICAgIHByb3RvdHlwZVtuYW1lXSA9IHR5cGVvZiBwcm9wW25hbWVdID09IFwiZnVuY3Rpb25cIiAmJlxuICAgICAgICB0eXBlb2YgX3N1cGVyW25hbWVdID09IFwiZnVuY3Rpb25cIiAmJiBmblRlc3QudGVzdChwcm9wW25hbWVdKSA/XG4gICAgICAgIChmdW5jdGlvbihuYW1lLCBmbil7XG4gICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIHRtcCA9IHRoaXMuX3N1cGVyO1xuXG4gICAgICAgICAgICAvLyBBZGQgYSBuZXcgLl9zdXBlcigpIG1ldGhvZCB0aGF0IGlzIHRoZSBzYW1lIG1ldGhvZFxuICAgICAgICAgICAgLy8gYnV0IG9uIHRoZSBzdXBlci1jbGFzc1xuICAgICAgICAgICAgdGhpcy5fc3VwZXIgPSBfc3VwZXJbbmFtZV07XG5cbiAgICAgICAgICAgIC8vIFRoZSBtZXRob2Qgb25seSBuZWVkIHRvIGJlIGJvdW5kIHRlbXBvcmFyaWx5LCBzbyB3ZVxuICAgICAgICAgICAgLy8gcmVtb3ZlIGl0IHdoZW4gd2UncmUgZG9uZSBleGVjdXRpbmdcbiAgICAgICAgICAgIHZhciByZXQgPSBmbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgdGhpcy5fc3VwZXIgPSB0bXA7XG5cbiAgICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgICAgfTtcbiAgICAgICAgfSkobmFtZSwgcHJvcFtuYW1lXSkgOlxuICAgICAgICBwcm9wW25hbWVdO1xuICAgIH1cblxuICAgIC8vIFRoZSBkdW1teSBjbGFzcyBjb25zdHJ1Y3RvclxuICAgIGZ1bmN0aW9uIENsYXNzKCkge1xuICAgICAgLy8gQWxsIGNvbnN0cnVjdGlvbiBpcyBhY3R1YWxseSBkb25lIGluIHRoZSBpbml0IG1ldGhvZFxuICAgICAgaWYgKCAhaW5pdGlhbGl6aW5nICYmIHRoaXMuaW5pdCApXG4gICAgICAgIHRoaXMuaW5pdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH1cblxuICAgIC8vIFBvcHVsYXRlIG91ciBjb25zdHJ1Y3RlZCBwcm90b3R5cGUgb2JqZWN0XG4gICAgQ2xhc3MucHJvdG90eXBlID0gcHJvdG90eXBlO1xuXG4gICAgLy8gRW5mb3JjZSB0aGUgY29uc3RydWN0b3IgdG8gYmUgd2hhdCB3ZSBleHBlY3RcbiAgICB2YXIgZnVuYyA9IG5ldyBGdW5jdGlvbihcbiAgICAgICAgXCJyZXR1cm4gZnVuY3Rpb24gXCIgKyBjbGFzc05hbWUgKyBcIigpeyB9XCJcbiAgICApKCk7XG4gICAgQ2xhc3MucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gZnVuYztcblxuICAgIC8vIEFuZCBtYWtlIHRoaXMgY2xhc3MgZXh0ZW5kYWJsZVxuICAgIENsYXNzLmV4dGVuZCA9IGFyZ3VtZW50cy5jYWxsZWU7XG5cbiAgICByZXR1cm4gQ2xhc3M7XG4gIH07XG5cbiAgLy9JIG9ubHkgYWRkZWQgdGhpcyBsaW5lXG4gIG1vZHVsZS5leHBvcnRzID0gQ2xhc3M7XG59KSgpO1xuIiwiXHJcbi8vIHRoZSBjbGFzcy5leHRlbmQgbnBtIG1vZHVsZSBtdXN0IGJlIGluY2x1ZGVkIHByaW9yIHRvIHRoaXNcclxuLy8gaWYgeW91IHVzZSB0aGUgaW5jbHVkZWQgbWluaW1pemVkIGZpbGUsIHdlJ3ZlIGJ1bmRsZWQgdGhhdFxyXG4vLyBtb2R1bGUgdG9nZXRoZXIgd2l0aCB0aGlzIG9iamVjdCBmb3IgeW91LlxyXG5cclxudmFyIFNlYXJjaGJhciA9IENsYXNzLmV4dGVuZCh7XHJcblx0c2VhcmNoYmFyOiBudWxsLFxyXG5cdHNlYXJjaGFibGU6IG51bGwsXHJcblx0aGlkZGVuQ2xhc3M6IFwic2VhcmNoYWJsZS1yb3ctaGlkZGVuXCIsXHJcblxyXG5cdGluaXQ6IGZ1bmN0aW9uKCkge1xyXG5cdFx0dGhpcy5zZWFyY2hiYXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnNlYXJjaGJhclwiKTtcclxuXHRcdHRoaXMuc2VhcmNoYWJsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc2VhcmNoYWJsZVwiKTtcclxuXHJcblx0XHQvLyB0byBoYXZlIGEgc2VhcmNoYmFyLCB3ZSBuZWVkIGJvdGggdGhlIHNlYXJjaGJhciBlbGVtZW50IGFuZFxyXG5cdFx0Ly8gdGhlIHNlYXJjaGFibGUgZGF0YSBzZXQuICB3aXRob3V0IHRob3NlLCB3ZSBjYW4gc2ltcGx5IHF1aXRcclxuXHRcdC8vIGJlY2F1c2UsIGNsZWFybHksIHRoaXMgcGFnZSBkb2Vzbid0IG5lZWQgdGhpcyBmdW5jdGlvbmFsaXR5LlxyXG5cclxuXHRcdGlmICghdGhpcy5zZWFyY2hiYXIgfHwgIXRoaXMuc2VhcmNoYWJsZSkge1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gbm93IHRoYXQgd2Uga25vdyB3ZSBoYXZlIHRob3NlLCB3ZSBjYW4gcGFyc2UgdGhlIHNlYXJjaGFibGVcclxuXHRcdC8vIGRhdGEgc2V0IHRvIHByZXBhcmUgaXQgZm9yIHVzZS4gIGl0J3MgcG9zc2libGUgdGhhdCB0aGlzIG1ldGhvZFxyXG5cdFx0Ly8gcmV0dXJucyBmYWxzZSB3aGVuIHRoZXJlIGFyZSBubyByb3dzIHdpdGhpbiB0aGUgc2V0IHRvIHdvcmtcclxuXHRcdC8vIHdpdGguXHJcblxyXG5cdFx0aWYgKCF0aGlzLnBhcnNlU2VhcmNoYWJsZSgpKSB7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBmaW5hbGx5LCBvdXIgc2VhcmNoYWJsZSBkYXRhIHNldCBpcyByZWFkeSB0byBnby4gIG5vdywgd2UgY2FuXHJcblx0XHQvLyBob29rIHVwIGV2ZW50cyB0byBvdXIgc2VhcmNoYmFyLlxyXG5cclxuXHRcdHZhciBlbGVtZW50cyA9IHRoaXMuZ2V0U2VhcmNoYmFyRWxlbWVudHMoKTtcclxuXHRcdGZvciAodmFyIGkgPSAwOyBpIDwgZWxlbWVudHMubGVuZ3RoOyArK2kpIHtcclxuXHRcdFx0dGhpcy5wcm9jZXNzU2VhcmNoYmFyRWxlbWVudChlbGVtZW50c1tpXSk7XHJcblx0XHR9XHJcblx0fSxcclxuXHJcblx0cGFyc2VTZWFyY2hhYmxlOiBmdW5jdGlvbigpIHtcclxuXHRcdHZhciByb3dzID0gdGhpcy5nZXRTZWFyY2hhYmxlUm93cygpO1xyXG5cclxuXHRcdC8vIGlmIHdlIGRvbid0IGhhdmUgcm93cywgdGhlbiB3ZSBjYW4gcXVpdC5cclxuXHJcblx0XHRpZiAocm93cy5sZW5ndGggPT09IDApIHtcclxuXHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIG90aGVyd2lzZSwgZm9yIHRoZSBjaGlsZHJlbiBvZiBvdXIgcm93cyAtLSB3aGljaCBhcmUgbGlrZWx5XHJcblx0XHQvLyB0YWJsZSBjZWxscywgYnV0IGNvdWxkIGJlIHNvbWV0aGluZyBlbHNlIC0tIHdlIHdhbnQgdG8gcHJvY2Vzc1xyXG5cdFx0Ly8gdGhlbSBpbmRpdmlkdWFsbHkgd2l0aCB0aGUgbWV0aG9kIGJlbG93LlxyXG5cclxuXHRcdGZvciAodmFyIGkgPSAwOyBpIDwgcm93cy5sZW5ndGg7ICsraSkge1xyXG5cdFx0XHR2YXIgY2VsbHMgPSByb3dzW2ldLnF1ZXJ5U2VsZWN0b3JBbGwoXCJbZGF0YS1zZWFyY2hiYXItdmFsdWVdXCIpO1xyXG5cdFx0XHRmb3IgKHZhciBqID0gMDsgaiA8IGNlbGxzLmxlbmd0aDsgKytqKSB7XHJcblx0XHRcdFx0dGhpcy5wcm9jZXNzQ2VsbChjZWxsc1tqXSwgcm93c1tpXSk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gdHJ1ZTtcclxuXHR9LFxyXG5cclxuXHRnZXRTZWFyY2hhYmxlUm93czogZnVuY3Rpb24oKSB7XHJcblxyXG5cdFx0Ly8gZm9yIG1heGltdW0gZmxleGliaWxpdHksIHdlIHdhbnQgdG8gbWFrZSBzdXJlIHRoYXQgYSBkZXZlbG9wZXJcclxuXHRcdC8vIHVzaW5nIG91ciBzZWFyY2hiYXIgY2FuIHNwZWNpZnkgd2hhdCBzaG91bGQgYmUgY29uc2lkZXJlZCBhXHJcblx0XHQvLyBzZWFyY2hhYmxlIHJvdy4gIGJ1dCwgaWYgdGhleSBkb24ndCBhbmQgaWYgdGhlIHNlYXJjaGFibGUgRE9NXHJcblx0XHQvLyBlbGVtZW50IGlzIGEgdGFibGUsIHRoZW4gd2UnbGwganVzdCB1c2UgdGhlIHJvd3MgaW4gaXRzIHRhYmxlXHJcblx0XHQvLyBib2R5IGJ5IGRlZmF1bHQuXHJcblxyXG5cdFx0dmFyIHJvd3MgPSB0aGlzLnNlYXJjaGFibGUucXVlcnlTZWxlY3RvckFsbChcIi5zZWFyY2hhYmxlLXJvd1wiKTtcclxuXHRcdGlmIChyb3dzLmxlbmd0aCA9PT0gMCAmJiB0aGlzLnNlYXJjaGFibGUudGFnTmFtZSA9PT0gXCJUQUJMRVwiKSB7XHJcblx0XHRcdHJvd3MgPSB0aGlzLnNlYXJjaGFibGUucXVlcnlTZWxlY3RvckFsbChcInRib2R5IHRyXCIpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiByb3dzO1xyXG5cdH0sXHJcblxyXG5cdHByb2Nlc3NDZWxsOiBmdW5jdGlvbihjZWxsLCByb3cpIHtcclxuXHJcblx0XHQvLyB0byBwcm9jZXNzIGEgY2VsbCwgd2Ugd2FudCB0byBhZGQgSFRNTDUgZGF0YSBhdHRyaWJ1dGVzIHRoYXRcclxuXHRcdC8vIGNvcnJlc3BvbmQgdG8gaW5mb3JtYXRpb24gZXh0cmFjdGVkIGZyb20gdGhlIGNlbGwgaXRzZWxmIHRvXHJcblx0XHQvLyB0aGUgc3BlY2lmaWVkIHJvdy4gIHRoaXMgaXMgYmVjYXVzZSBvdXIgc2VhcmNoIG1ldGhvZCBsb29rc1xyXG5cdFx0Ly8gYXQgdGhlIHJvd3Mgd2hlbiBtYXRjaGluZyBlbnRyaWVzIGFnYWluc3QgZGF0YS5cclxuXHJcblx0XHR2YXIgYXR0ciA9IFwiZGF0YS1cIiArIGNlbGwuZ2V0QXR0cmlidXRlKFwiaGVhZGVyc1wiKTtcclxuXHRcdHZhciB2YWx1ZSA9IGNlbGwuZ2V0QXR0cmlidXRlKFwiZGF0YS1zZWFyY2hiYXItdmFsdWVcIik7XHJcblx0XHRyb3cuc2V0QXR0cmlidXRlKGF0dHIsIHZhbHVlKTtcclxuXHJcblx0XHRpZiAoY2VsbC5nZXRBdHRyaWJ1dGUoXCJkYXRhLXNlYXJjaGJhci12YWx1ZS1saXN0XCIpID09PSBcIjFcIikge1xyXG5cdFx0XHRyb3cuc2V0QXR0cmlidXRlKGF0dHIgKyBcIi1saXN0XCIsIDEpO1xyXG5cdFx0fVxyXG5cdH0sXHJcblxyXG5cdGdldFNlYXJjaGJhckVsZW1lbnRzOiBmdW5jdGlvbigpIHtcclxuXHJcblx0XHQvLyBvdXIgc2VhcmNoYmFyIHVzZXMgdGhlc2UgSFRNTCBlbGVtZW50cyBhdCB0aGUgbW9tZW50LiAgaWYgd2VcclxuXHRcdC8vIGFkIG1vcmUsIHdlJ2xsIG5lZWQgdG8gdXBkYXRlIHRoaXMgbGlzdC5cclxuXHJcblx0XHRyZXR1cm4gdGhpcy5zZWFyY2hiYXIucXVlcnlTZWxlY3RvckFsbChcImlucHV0LCBzZWxlY3QsIGJ1dHRvblwiKTtcclxuXHR9LFxyXG5cclxuXHRwcm9jZXNzU2VhcmNoYmFyRWxlbWVudDogZnVuY3Rpb24oZWxlbWVudCkge1xyXG5cdFx0dmFyIGV2ZW50ID0gXCJcIiwgd2FpdCA9IDA7XHJcblxyXG5cdFx0Ly8gdGhlIGV2ZW50IHdlIHdhbnQgdG8gdXNlIGlzIGJhc2VkIG9uIHRoZSB0eXBlIG9mIGVsZW1lbnQgdGhhdFxyXG5cdFx0Ly8gd2UncmUgd29ya2luZyB3aXRoLiAgbW9zdCBvZiBvdXIgZXZlbnRzIGRvbid0IG5lZWQgdG8gYmVcclxuXHRcdC8vIGRlYm91bmNlZCwgYnV0IGlmIHdlIHJ1biBpbnRvIG9uZSB0aGF0IGRvZXMsIHdlIGNhbiBzZXQgb3VyXHJcblx0XHQvLyB3YWl0IHZhcmlhYmxlIHRvIHNvbWV0aGluZyBvdGhlciB0aGFuIHplcm8uXHJcblxyXG5cdFx0c3dpdGNoIChlbGVtZW50LnR5cGUpIHtcclxuXHRcdFx0Y2FzZSBcInRleHRcIjpcclxuXHRcdFx0XHRldmVudCA9IFwia2V5dXBcIjtcclxuXHRcdFx0XHR3YWl0ID0gMTUwO1xyXG5cdFx0XHRcdGJyZWFrO1xyXG5cclxuXHRcdFx0Y2FzZSBcInNlbGVjdC1vbmVcIjpcclxuXHRcdFx0XHRldmVudCA9IFwiY2hhbmdlXCI7XHJcblx0XHRcdFx0YnJlYWs7XHJcblxyXG5cdFx0XHRjYXNlIFwiY2hlY2tib3hcIjpcclxuXHRcdFx0XHRldmVudCA9IFwiY2xpY2tcIjtcclxuXHRcdFx0XHRicmVhaztcclxuXHJcblx0XHRcdGNhc2UgXCJyZXNldFwiOlxyXG5cdFx0XHRcdGV2ZW50ID0gXCJjbGlja1wiO1xyXG5cdFx0XHRcdGJyZWFrO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmIChldmVudC5sZW5ndGggPiAwKSB7XHJcblxyXG5cdFx0XHQvLyBpZiB3ZSBpZGVudGlmaWVkIGFuIGV2ZW50IHRvIGxpc3RlbiBmb3IsIHdlJ2xsIG5vdyBpZGVudGlmeVxyXG5cdFx0XHQvLyB3aGljaCBmdW5jdGlvbiB0byBjYWxsLiAgaWYgd2UncmUgbm90IG1lc3Npbmcgd2l0aCB0aGUgcmVzZXRcclxuXHRcdFx0Ly8gZWxlbWVudCwgd2Ugc2VhcmNoOyBvdGhlcndpc2Ugd2UgcmVzZXQuXHJcblxyXG5cdFx0XHR2YXIgZnVuYyA9IGVsZW1lbnQudHlwZSAhPT0gXCJyZXNldFwiXHJcblx0XHRcdFx0PyB0aGlzLmRlYm91bmNlKHRoaXMuc2VhcmNoLCB3YWl0KS5iaW5kKHRoaXMpXHJcblx0XHRcdFx0OiB0aGlzLnJlc2V0LmJpbmQodGhpcyk7XHJcblxyXG5cdFx0XHRlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoZXZlbnQsIGZ1bmMpO1xyXG5cdFx0fVxyXG5cdH0sXHJcblxyXG5cdHNlYXJjaDogZnVuY3Rpb24oKSB7XHJcblx0XHR2YXIgYmVmb3JlU2VhcmNoID0gbmV3IEV2ZW50KFwic2VhcmNoYmFyOmJlZm9yZVNlYXJjaFwiKTtcclxuXHRcdHZhciBjYW5jZWxsZWQgPSAhdGhpcy5zZWFyY2hiYXIuZGlzcGF0Y2hFdmVudChiZWZvcmVTZWFyY2gpO1xyXG5cdFx0aWYgKGNhbmNlbGxlZCkge1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gYXNzdW1pbmcgc29tZXRoaW5nIGVsc2UgZGlkbid0IGNhbmNlbCBvdXIgc2VhcmNoLCB0aGUgZmlyc3RcclxuXHRcdC8vIHRoaW5nIHdlIGRvIGlzIHJlc2V0IG91ciB0YWJsZS4gIHRoYXQgd2F5LCB3ZSBrbm93IHRoYXQgd2VcclxuXHRcdC8vIHN0YXJ0IHdpdGggdGhlIGVudGlyZSB0aGluZyB2aXNpYmxlIGFuZCB3ZSdsbCBmaW5kIHRoZSBvbmVzXHJcblx0XHQvLyB0aGF0IG5lZWQgdG8gYmUgaGlkZGVuIGJlbG93LlxyXG5cclxuXHRcdHRoaXMucmVzZXRTZWFyY2hhYmxlKCk7XHJcblx0XHR2YXIgcm93cyA9IHRoaXMuZ2V0U2VhcmNoYWJsZVJvd3MoKTtcclxuXHRcdGZvciAodmFyIGkgPSAwOyBpIDwgcm93cy5sZW5ndGg7ICsraSkge1xyXG5cdFx0XHR2YXIgcm93ID0gcm93c1tpXSwgc2hvdyA9IHRydWU7XHJcblxyXG5cdFx0XHQvLyBmb3IgZWFjaCByb3csIHdlIG5lZWQgdG8gY29tcGFyZSB0aGUgaW5mb3JtYXRpb24gaW4gdGhlXHJcblx0XHRcdC8vIEhUTUw1IGRhdGEgYXR0cmlidXRlcyBhZGRlZCBieSB0aGUgcGFyc2VTZWFyY2hhYmxlKCkgbWV0aG9kXHJcblx0XHRcdC8vIGFib3ZlIGFnYWluc3QgdGhlIHZhbHVlcyBpbiBvdXIgc2VhcmNoYmFyIGVsZW1lbnRzLlxyXG5cclxuXHRcdFx0dmFyIGVsZW1lbnRzID0gdGhpcy5nZXRTZWFyY2hiYXJFbGVtZW50cygpO1xyXG5cdFx0XHRmb3IgKHZhciBqID0gMDsgaiA8IGVsZW1lbnRzLmxlbmd0aDsgaisrKSB7XHJcblx0XHRcdFx0aWYgKCFzaG93KSB7XHJcblxyXG5cdFx0XHRcdFx0Ly8gd2UgdXNlIEFORCBsb2dpYyBoZXJlLiAgdGhlIGZpcnN0IHRoaW5nIHRoYXQgd291bGRcclxuXHRcdFx0XHRcdC8vIGhpZGUgb3VyIHJvdyBtZWFucyB0aGUgcm93IGlzIGhpZGRlbiBhbmQgd2UgY2FuXHJcblx0XHRcdFx0XHQvLyBza2lwIGFsbCBvdGhlciBjcml0ZXJpb24uXHJcblxyXG5cdFx0XHRcdFx0Y29udGludWU7XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHR2YXIgZWxlbWVudCA9IGVsZW1lbnRzW2pdO1xyXG5cdFx0XHRcdHZhciB2YWx1ZSA9IHRoaXMuZ2V0VmFsdWUoZWxlbWVudCk7XHJcblx0XHRcdFx0dmFyIGF0dHIgPSB0aGlzLmdldEF0dHIoZWxlbWVudCk7XHJcblxyXG5cdFx0XHRcdC8vIGlmIHdlIGRvbid0IGhhdmUgYW4gYXR0cmlidXRlIG9yIHZhbHVlIG9yIGlmIHRoZSB2YWx1ZVxyXG5cdFx0XHRcdC8vIHdlIGRvIGhhdmUgaW5kaWNhdGVzIHRoYXQgd2Ugc2hvdWxkIGJlIHNob3dpbmcgYWxsIG9mXHJcblx0XHRcdFx0Ly8gb3VyIHJvd3MsIHdlIGNhbiBzaW1wbHkgbW92ZSBvbjsgdGhpcyBjcml0ZXJpYSBpcyxcclxuXHRcdFx0XHQvLyBlZmZlY3RpdmVseSwgYWx3YXlzIG1ldC5cclxuXHJcblx0XHRcdFx0aWYgKCFhdHRyIHx8ICF2YWx1ZSB8fCB2YWx1ZSA9PT0gXCJhbGxcIikge1xyXG5cdFx0XHRcdFx0Y29udGludWU7XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHR2YXIgY3JpdGVyaW9uID0gZWxlbWVudC50eXBlICE9PSBcInRleHRcIlxyXG5cdFx0XHRcdFx0PyB0aGlzLm5vblRleHRTZWFyY2gocm93LCBhdHRyLCB2YWx1ZSlcclxuXHRcdFx0XHRcdDogdGhpcy50ZXh0U2VhcmNoKHJvdywgYXR0ciwgdmFsdWUpO1xyXG5cclxuXHRcdFx0XHRzaG93ID0gc2hvdyAmJiBjcml0ZXJpb247XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGlmICghc2hvdykge1xyXG5cclxuXHRcdFx0XHQvLyBmaW5hbGx5LCBpZiB0aGlzIHJvdyBzaG91bGQgbm90IGJlIHNob3duLCB0aGVuIHdlIGFkZFxyXG5cdFx0XHRcdC8vIHRoZSBoaWRkZW4gY2xhc3MgdG8gaXQuXHJcblxyXG5cdFx0XHRcdHJvdy5jbGFzc0xpc3QuYWRkKHRoaXMuaGlkZGVuQ2xhc3MpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5zZWFyY2hiYXIuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoXCJzZWFyY2hiYXI6YWZ0ZXJTZWFyY2hcIikpO1xyXG5cdH0sXHJcblxyXG5cdGdldFZhbHVlOiBmdW5jdGlvbihlbGVtZW50KSB7XHJcblxyXG5cdFx0Ly8gdGV4dCwgc2VsZWN0cywgYW5kIGNoZWNrYm94ZXMgYWxsIHdvcmsgZGlmZmVyZW50bHkgd2l0aFxyXG5cdFx0Ly8gcmVzcGVjdCB0byB3aGF0IHdlIGNvbnNpZGVyIG91ciBcInZhbHVlXCIgZm9yIHNlYXJjaGluZ1xyXG5cdFx0Ly8gcHVycG9zZXMuICB0aGlzIHN3aXRjaCBzdGF0ZW1lbnQgbWl4ZXMgdGhpbmdzIHVwIGFuZFxyXG5cdFx0Ly8gZ3JhYnMgb25seSB3aGF0IHdlIG5lZWQgZHVyaW5nIG91ciBzZWFyY2ggYWJvdmUgdG8gbWFrZVxyXG5cdFx0Ly8gdGhpbmdzIGhhcHBlbi5cclxuXHJcblx0XHRzd2l0Y2ggKGVsZW1lbnQudHlwZSkge1xyXG5cdFx0XHRjYXNlIFwidGV4dFwiOlxyXG5cdFx0XHRcdHJldHVybiBlbGVtZW50LnZhbHVlO1xyXG5cclxuXHRcdFx0Y2FzZSBcInNlbGVjdC1vbmVcIjpcclxuXHRcdFx0XHRyZXR1cm4gZWxlbWVudC5vcHRpb25zW2VsZW1lbnQuc2VsZWN0ZWRJbmRleF0udmFsdWU7XHJcblxyXG5cdFx0XHRjYXNlIFwiY2hlY2tib3hcIjpcclxuXHRcdFx0XHRyZXR1cm4gZWxlbWVudC5jaGVja2VkO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiBcIlwiO1xyXG5cdH0sXHJcblxyXG5cdGdldEF0dHI6IGZ1bmN0aW9uKGVsZW1lbnQpIHtcclxuXHJcblx0XHQvLyB0aGUgSFRNTDUgZGF0YSBlbGVtZW50cyB0aGF0IHBhcnNlU2VhcmNoYWJsZSgpIGNyZWF0ZXNcclxuXHRcdC8vIGFyZSBkYXRhLVtpZF0gd2hlcmUgdGhlIGlkIGlzIHRoZSB2YWx1ZSBvZiBvdXIgZWxlbWVudCdzXHJcblx0XHQvLyBJRCBhdHRyaWJ1dGUuXHJcblxyXG5cdFx0dmFyIGlkID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJpZFwiKTtcclxuXHJcblx0XHRpZiAoaWQpIHtcclxuXHJcblx0XHRcdC8vIGlmIHdlIGhhdmUgYW4gSUQsIHRoZW4gd2UgbmVlZCB0byByZW1vdmUgZXZlcnl0aGluZ1xyXG5cdFx0XHQvLyBhZnRlciB0aGUgdW5kZXJzY29yZSwgaW5jbHVkaW5nIHRoZSB1bmRlcnNjb3JlLiAgd2VcclxuXHRcdFx0Ly8gZXhwZWN0IG91ciBJRHMgZm9yIHNlYXJjaGluZyBlbGVtZW50cyB0byBiZSBpbiB0aGVcclxuXHRcdFx0Ly8gZm9ybSBvZiBbaWRdX1t0eXBlXSwgc28gdGhpcyBzaW1wbHkgbGVhdmVzIHVzIHdpdGhcclxuXHRcdFx0Ly8gdGhlIGlkLlxyXG5cclxuXHRcdFx0aWQgPSBpZC5yZXBsYWNlKC9fLiovLCBcIlwiKTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHJldHVybiBcIlwiO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIHN0aWxsIGhlcmU/ICB0aGVuIHdlIGNhbiBjb25zdHJ1Y3QgdGhlIG91ciBkYXRhXHJcblx0XHQvLyBhdHRyaWJ1dGUgdXNpbmcgdGhlIElEIHdlJ3JlIGxlZnQgd2l0aC5cclxuXHJcblx0XHRyZXR1cm4gXCJkYXRhLVwiICsgaWQ7XHJcblx0fSxcclxuXHJcblx0bm9uVGV4dFNlYXJjaDogZnVuY3Rpb24ocm93LCBhdHRyLCB2YWx1ZSkge1xyXG5cclxuXHRcdC8vIGlmIG91ciByb3cgaGFzIGEgbGlzdCBmbGFnIGZvciB0aGlzIGF0dHJpYnV0ZSwgdGhlbiB3ZVxyXG5cdFx0Ly8gd2FudCB0byBzZWUgaWYgb3VyIGF0dHJpYnV0ZSBjb250YWlucyB0aGUgdmFsdWUuICBvdGhlcndpc2UsXHJcblx0XHQvLyB3ZSBjaGVjayB0byBzZWUgdGhlIGF0dHJpYnV0ZSBtYXRjaGVzIGl0LiAgd2l0aCByZXNwZWN0IHRvXHJcblx0XHQvLyB0aGUgbWF0Y2hlcygpIGNhbGwgaGVyZSwgaWYgd2UgYXNzdW1lIG91ciB2YWx1ZSBpcyAxLCB0aGVuXHJcblx0XHQvLyB3ZSBzZWFyY2ggZm9yIF8xXy4gIHRoaXMgaXMgdG8gYXZvaWQgaW52YWxpZCBzZWxlY3RvciBlcnJvcnNcclxuXHRcdC8vIHdpdGhpbiB0aGUgamF2YXNjcmlwdC4gIGZ1cnRoZXIsIGl0IGhlbHBzIGRpc3Rpbmd1aXNoIGJldHdlZW5cclxuXHRcdC8vIF8xXyBhbmQgXzExXyBvciBfd29uXyBhbmQgX3dvbmRlcl8sIGZvciBleGFtcGxlLlxyXG5cclxuXHRcdHJldHVybiByb3cuaGFzQXR0cmlidXRlKGF0dHIgKyBcIi1saXN0XCIpXHJcblx0XHRcdD8gcm93Lm1hdGNoZXMoXCJbXCIgKyBhdHRyICsgXCIqPV9cIiArIHZhbHVlICsgXCJfXVwiKVxyXG5cdFx0XHQ6IHJvdy5nZXRBdHRyaWJ1dGUoYXR0cikgPT09IHZhbHVlO1xyXG5cdH0sXHJcblxyXG5cdHRleHRTZWFyY2g6IGZ1bmN0aW9uKHJvdywgYXR0ciwgdmFsdWUpIHtcclxuXHJcblx0XHQvLyBmb3IgdGV4dCBzZWFyY2hlcywgd2UgY29uc3RydWN0IGEgcmVnZXggZnJvbSB0aGUgdmFsdWUgb2ZcclxuXHRcdC8vIG91ciBzZWFyY2ggZmllbGQgYW5kIHNlZSBpZiB0aGlzIHJvdyBtYXRjaGVzIGl0LiAgd2UgcHV0XHJcblx0XHQvLyB0aGlzIGFsbCBpbnNpZGUgYSB0cnkvY2F0Y2ggYmxvY2sgYmVjYXVzZSBpdCdzIHBvc3NpYmxlIHRvXHJcblx0XHQvLyBjcmVhdGUgYSB2YWx1ZSB0aGF0IGNhbid0IGJlIGEgcmVnZXgsIGFuZCB0aGVuIGFuIGV4Y2VwdGlvblxyXG5cdFx0Ly8gaXMgdGhyb3duLlxyXG5cclxuXHRcdHRyeSB7XHJcblx0XHRcdHZhciBwYXR0ZXJuID0gbmV3IFJlZ0V4cCh2YWx1ZSwgXCJpXCIpO1xyXG5cdFx0XHRyZXR1cm4gcm93LmdldEF0dHJpYnV0ZShhdHRyKS5tYXRjaChwYXR0ZXJuKTtcclxuXHRcdH0gY2F0Y2ggKGUpIHtcclxuXHJcblx0XHRcdC8vIGlmIHdlIGNvdWxkbid0IGV2ZW4gbWFrZSBvdXIgcGF0dGVybiwgdGhlbiB3ZSdsbCBhc3N1bWVcclxuXHRcdFx0Ly8gdGhhdCB3aGF0ZXZlciB3ZSBoYXZlIGNvdWxkIG5vdCBiZSBtYXRjaGVkIGFuZCByZXR1cm5cclxuXHRcdFx0Ly8gZmFsc2UuXHJcblxyXG5cdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHR9XHJcblx0fSxcclxuXHJcblx0cmVzZXQ6IGZ1bmN0aW9uKCkge1xyXG5cdFx0dmFyIGJlZm9yZVJlc2V0ID0gbmV3IEV2ZW50KFwic2VhcmNoYmFyOnJlc2V0XCIpO1xyXG5cdFx0dmFyIGNhbmNlbGxlZCA9ICF0aGlzLnNlYXJjaGJhci5kaXNwYXRjaEV2ZW50KGJlZm9yZVJlc2V0KTtcclxuXHJcblx0XHRpZiAoIWNhbmNlbGxlZCkge1xyXG5cclxuXHRcdFx0Ly8gaWYgbm8gb25lIGNhbmNlbGxlZCBvdXIgcmVzZXQsIHRoZW4gd2UganVzdCByZXNldCB0aGVcclxuXHRcdFx0Ly8gc2VhcmNoYmFyIGZvcm0gYW5kIG91ciBzZWFyY2hhYmxlIGRhdGEgc2V0LlxyXG5cclxuXHRcdFx0dGhpcy5zZWFyY2hiYXIucmVzZXQoKTtcclxuXHRcdFx0dGhpcy5yZXNldFNlYXJjaGFibGUoKTtcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gZmFsc2U7XHJcblx0fSxcclxuXHJcblx0cmVzZXRTZWFyY2hhYmxlOiBmdW5jdGlvbigpIHtcclxuXHRcdHZhciByb3dzID0gdGhpcy5nZXRTZWFyY2hhYmxlUm93cygpO1xyXG5cclxuXHRcdC8vIHJlc2V0dGluZyBvdXIgZGF0YSBzZXQgaXMgc2ltcGxlOiAgd2UganVzdCByZW1vdmUgdGhlIGhpZGRlblxyXG5cdFx0Ly8gY2xhc3MgZnJvbSBhbGwgcm93cy5cclxuXHJcblx0XHRmb3IgKHZhciBpID0gMDsgaSA8IHJvd3MubGVuZ3RoOyArK2kpIHtcclxuXHRcdFx0cm93c1tpXS5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuaGlkZGVuQ2xhc3MpO1xyXG5cdFx0fVxyXG5cdH0sXHJcblxyXG5cdGRlYm91bmNlOiBmdW5jdGlvbihmdW5jLCB3YWl0LCBpbW1lZGlhdGUpIHtcclxuXHRcdGlmICh3YWl0ID09PSAwKSB7XHJcblx0XHRcdHJldHVybiBmdW5jO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIHNvdXJjZTogaHR0cHM6Ly9kYXZpZHdhbHNoLm5hbWUvamF2YXNjcmlwdC1kZWJvdW5jZS1mdW5jdGlvblxyXG5cclxuXHRcdHZhciB0aW1lb3V0O1xyXG5cdFx0cmV0dXJuIGZ1bmN0aW9uKCkge1xyXG5cdFx0XHR2YXIgY29udGV4dCA9IHRoaXMsIGFyZ3MgPSBhcmd1bWVudHM7XHJcblx0XHRcdHZhciBsYXRlciA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdHRpbWVvdXQgPSBudWxsO1xyXG5cdFx0XHRcdGlmICghaW1tZWRpYXRlKSBmdW5jLmFwcGx5KGNvbnRleHQsIGFyZ3MpO1xyXG5cdFx0XHR9O1xyXG5cdFx0XHR2YXIgY2FsbE5vdyA9IGltbWVkaWF0ZSAmJiAhdGltZW91dDtcclxuXHRcdFx0Y2xlYXJUaW1lb3V0KHRpbWVvdXQpO1xyXG5cdFx0XHR0aW1lb3V0ID0gc2V0VGltZW91dChsYXRlciwgd2FpdCk7XHJcblx0XHRcdGlmIChjYWxsTm93KSBmdW5jLmFwcGx5KGNvbnRleHQsIGFyZ3MpO1xyXG5cdFx0fTtcclxuXHR9XHJcbn0pO1xyXG4iLCJ2YXIgRm9jdXNlciA9IENsYXNzLmV4dGVuZCh7XHJcblx0aW5pdDogZnVuY3Rpb24oKSB7XHJcblx0XHR2YXIgZWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJbYXV0b2ZvY3VzXVwiKTtcclxuXHRcdGlmIChlbGVtZW50ICYmIGVsZW1lbnQubGVuZ3RoID4gMCkge1xyXG5cdFx0XHRlbGVtZW50WzBdLmZvY3VzKCk7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBpZiB3ZSBoYXZlbid0IGxlZnQgeWV0LCB0aGVuIHdlJ2xsIGNoZWNrIGZvciBhIHNoYWRvd2xhYiBmb3JtXHJcblx0XHQvLyBhbmQgaWYgd2UgZmluZCBpdCwgd2UgZmluZCBpdCdzIGZpcnN0IGVsZW1lbnQgYW5kIGZvY3VzIGl0LlxyXG5cclxuXHRcdHZhciBmb3JtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzaGFkb3dsYWItZm9ybVwiKTtcclxuXHRcdGlmIChmb3JtKSB7XHJcblx0XHRcdHZhciBpbnB1dHMgPSBmb3JtLnF1ZXJ5U2VsZWN0b3IoXCJpbnB1dCwgc2VsZWN0LCB0ZXh0YXJlYVwiKTtcclxuXHRcdFx0aWYgKGlucHV0cyAmJiBpbnB1dHMubGVuZ3RoID4gMCkge1xyXG5cdFx0XHRcdGlucHV0c1swXS5mb2N1cygpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG59KTtcclxuIiwidmFyIFN1bW1hcml6ZXIgPSBDbGFzcy5leHRlbmQoe1xyXG5cdGVsZW1lbnQ6IG51bGwsXHJcblxyXG5cdC8vIHRoaXMgb2JqZWN0IGVuY2Fwc3VsYXRlcyB0aGUgYmVoYXZpb3JzIG5lY2Vzc2FyeSB0byBoYW5kbGUgdGhlXHJcblx0Ly8gc2hvd2luZyBhbmQgaGlkaW5nIG9mIGluZm9ybWF0aW9uIGluIHN1bW1hcml6ZWQgdGFibGVzLiAgaXQgdXNlZFxyXG5cdC8vIHRvIGJlIGEgalF1ZXJ5IHBsdWdpbjsgdGhpcyBpcyB0aGUgcHVyZS1KUyBwb3J0IG9mIGl0LiAgaXRcclxuXHQvLyByZXF1aXJlcyB0aGUgY2xhc3MuZXh0ZW5kIG5wbSBtb2R1bGUuXHJcblxyXG5cdGluaXQ6IGZ1bmN0aW9uKGVsZW1lbnQpIHtcclxuXHRcdGlmICghZWxlbWVudCkge1xyXG5cdFx0XHRlbGVtZW50ID0gdGhpcy5nZXRFbGVtZW50KCk7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKGVsZW1lbnQudGFnTmFtZSAmJlxyXG5cdFx0XHRlbGVtZW50LnRhZ05hbWUgPT09IFwiVEFCTEVcIiAmJlxyXG5cdFx0XHRlbGVtZW50Lm1hdGNoZXMoXCIuc3VtbWFyaXplZFwiKVxyXG5cdFx0KSB7XHJcblxyXG5cdFx0XHQvLyBub3cgdGhhdCB3ZSBrbm93IHRoZSBlbGVtZW50IGlzIGEgdGFibGUgYW5kIHRoYXQgaXQnc1xyXG5cdFx0XHQvLyBzdW1tYXJpemVkLCB3ZSBjYW4gYXR0YWNoIG91ciBiZWhhdmlvcnMgdG8gaXQuXHJcblxyXG5cdFx0XHR2YXIgY2xpY2tlcnMgPSBlbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuc3VtbWFyeSAqOmZpcnN0LWNoaWxkIGFcIik7XHJcblx0XHRcdGZvcih2YXIgaT0wOyBpIDwgY2xpY2tlcnMubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0XHRjbGlja2Vyc1tpXS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5zdW1tYXJ5Q2xpY2tlZC5iaW5kKHRoaXMpKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH0sXHJcblxyXG5cdGdldEVsZW1lbnQ6IGZ1bmN0aW9uKCkge1xyXG5cclxuXHRcdC8vIHRvIGdldCBvdXIgZWxlbWVudCwgd2Ugc2ltcGx5IGxvb2sgZm9yIGEgdGFibGUgdGhhdCdzIHN1bW1hcml6ZWQuXHJcblx0XHQvLyBhdCB0aGUgbW9tZW50LCB3ZSBkb24ndCB3b3JyeSBpZiB0aGVyZSdzIG1vcmUgdGhhbiBvbmU7IHRoYXQnbGxcclxuXHRcdC8vIGJlIGZvciB0aGUgZnV0dXJlIGlmIG5lY2Vzc2FyeS5cclxuXHJcblx0XHRyZXR1cm4gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcInRhYmxlLnN1bW1hcml6ZWRcIik7XHJcblx0fSxcclxuXHJcblx0c3VtbWFyeUNsaWNrZWQ6IGZ1bmN0aW9uKGV2ZW50KSB7XHJcblxyXG5cdFx0Ly8gd2hlbiBvbmUgb2Ygb3VyIHN1bW1hcmllcyBpcyBjbGlja2VkLCB3ZSB3YW50IHRvIGdldCB0aGVcclxuXHRcdC8vIG5lYXJlc3QgPHRib2R5PiBlbGVtZW50IGFuZCB0b2dnbGUgaXQncyBjbGlja2VkIGNsYXNzLlxyXG5cclxuXHRcdHZhciB0Ym9keSA9IHRoaXMuZ2V0Q2xvc2VzdChldmVudC50YXJnZXQsIFwidGJvZHlcIik7XHJcblx0XHR0aGlzLnRvZ2dsZUNsYXNzKHRib2R5LCBcImNsaWNrZWRcIik7XHJcblx0XHRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuXHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcblx0fSxcclxuXHJcblx0Z2V0Q2xvc2VzdDogZnVuY3Rpb24oZWxlbWVudCwgdGFyZ2V0KSB7XHJcblxyXG5cdFx0Ly8gdG8gZmluZCB0aGUgY2xvc2VzdCB0YXJnZXQgbWF0Y2ggdG8gb3VyIGVsZW1lbnQsIHdlIGNhblxyXG5cdFx0Ly8gdXNlIGEgZG8td2hpbGUgbG9vcC4gIHdlJ2xsIHNlZSBpZiBlbGVtZW50IG1hdGNoZXMgb3VyXHJcblx0XHQvLyB0YXJnZXQgYW5kIHRoZW4gd2hlbiB3ZSBmaW5kIHRoZSBtYXRjaCwgd2UgcmV0dXJuIGl0LlxyXG5cclxuXHRcdGRvIHtcclxuXHRcdFx0aWYgKGVsZW1lbnQubWF0Y2hlcyh0YXJnZXQpKSB7XHJcblx0XHRcdFx0cmV0dXJuIGVsZW1lbnQ7XHJcblx0XHRcdH1cclxuXHRcdH0gd2hpbGUgKGVsZW1lbnQgPSBlbGVtZW50LnBhcmVudE5vZGUpO1xyXG5cclxuXHRcdC8vIG90aGVyd2lzZSwgaWYgd2Ugd29yayBvdXIgd2F5IGFsbCB0aGUgd2F5IHRvIHRoZSB0b3Agb2ZcclxuXHRcdC8vIG91ciBET00gdHJlZSwgd2UnbGwganVzdCByZXR1cm4gbnVsbCBpbnN0ZWFkLlxyXG5cclxuXHRcdHJldHVybiBudWxsO1xyXG5cdH0sXHJcblxyXG5cdHRvZ2dsZUNsYXNzOiBmdW5jdGlvbihlbGVtZW50LCBjbGFzc05hbWUpIHtcclxuXHRcdGVsZW1lbnQuY2xhc3NMaXN0LnRvZ2dsZShjbGFzc05hbWUsICFlbGVtZW50LmNsYXNzTGlzdC5jb250YWlucyhjbGFzc05hbWUpKTtcclxuXHR9XHJcbn0pO1xyXG4iXX0=
